
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MM Stock Scanner - Gestion de colis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/@fullcalendar/core@6.1.8/index.global.min.js"></script>
    <script src="https://unpkg.com/@fullcalendar/daygrid@6.1.8/index.global.min.js"></script>
    <script src="https://unpkg.com/@fullcalendar/interaction@6.1.8/index.global.min.js"></script>
    <script src="https://unpkg.com/@fullcalendar/vue3@6.1.8/index.global.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        #map { height: 300px; }
        .fc-daygrid-event {
            white-space: normal !important;
        }
        .scanner-input {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-blue-600 text-white shadow-lg">
            <div class="container mx-auto px-4 py-4 flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                    </svg>
                    <h1 class="text-xl font-bold">MM Stock Scanner</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <button @click="toggleDarkMode" class="p-2 rounded-full hover:bg-blue-700 transition">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                        </svg>
                    </button>
                    <div class="relative">
                        <button @click="userMenuOpen = !userMenuOpen" class="flex items-center space-x-2 focus:outline-none">
                            <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold">
                                {{ userInitials }}
                            </div>
                        </button>
                        <div v-if="userMenuOpen" @click.away="userMenuOpen = false" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50">
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Profil</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Paramètres</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Déconnexion</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow container mx-auto px-4 py-6">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                <!-- Sidebar -->
                <aside class="lg:col-span-1">
                    <nav class="bg-white rounded-lg shadow p-4">
                        <ul class="space-y-2">
                            <li>
                                <router-link to="/dashboard" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-blue-50 text-blue-600">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
                                    </svg>
                                    <span>Tableau de bord</span>
                                </router-link>
                            </li>
                            <li>
                                <router-link to="/scan" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-blue-50 text-gray-700">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 22V12h6v10" />
                                    </svg>
                                    <span>Scanner colis</span>
                                </router-link>
                            </li>
                            <li>
                                <router-link to="/shipments" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-blue-50 text-gray-700">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                                    </svg>
                                    <span>Expéditions</span>
                                </router-link>
                            </li>
                            <li>
                                <router-link to="/labels" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-blue-50 text-gray-700">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                    </svg>
                                    <span>Étiquettes</span>
                                </router-link>
                            </li>
                            <li>
                                <router-link to="/calendar" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-blue-50 text-gray-700">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                    <span>Calendrier</span>
                                </router-link>
                            </li>
                            <li>
                                <router-link to="/map" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-blue-50 text-gray-700">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                                    </svg>
                                    <span>Géolocalisation</span>
                                </router-link>
                            </li>
                        </ul>
                    </nav>

                    <!-- Quick Stats -->
                    <div class="bg-white rounded-lg shadow p-4 mt-4">
                        <h3 class="font-semibold text-gray-700 mb-3">Statistiques rapides</h3>
                        <div class="space-y-3">
                            <div>
                                <p class="text-sm text-gray-500">Colis aujourd'hui</p>
                                <p class="text-xl font-bold">{{ stats.today }}</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">Colis cette semaine</p>
                                <p class="text-xl font-bold">{{ stats.week }}</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">En attente</p>
                                <p class="text-xl font-bold">{{ stats.pending }}</p>
                            </div>
                        </div>
                    </div>
                </aside>

                <!-- Main Content Area -->
                <div class="lg:col-span-3 space-y-6">
                    <!-- Scanner Section -->
                    <section v-if="activeTab === 'scan'" class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold text-gray-800">Scanner un colis</h2>
                            <button @click="printLastLabel" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                                </svg>
                                <span>Imprimer la dernière étiquette</span>
                            </button>
                        </div>

                        <div class="mb-6">
                            <label for="scanner-input" class="block text-sm font-medium text-gray-700 mb-2">Scanner le code-barres</label>
                            <input 
                                id="scanner-input" 
                                ref="scannerInput"
                                v-model="scannedCode" 
                                @keyup.enter="processScan"
                                class="scanner-input w-full px-4 py-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="Prêt à scanner..."
                                autofocus
                            />
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h3 class="font-medium text-gray-800 mb-3">Détails du colis</h3>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm text-gray-500">Code colis</label>
                                        <p class="font-medium">{{ currentPackage.code || '---' }}</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-500">Client</label>
                                        <p class="font-medium">{{ currentPackage.client || '---' }}</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-500">Destination</label>
                                        <p class="font-medium">{{ currentPackage.destination || '---' }}</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm text-gray-500">Statut</label>
                                        <p class="font-medium">
                                            <span :class="{
                                                'bg-yellow-100 text-yellow-800': currentPackage.status === 'En préparation',
                                                'bg-blue-100 text-blue-800': currentPackage.status === 'En transit',
                                                'bg-green-100 text-green-800': currentPackage.status === 'Livré',
                                                'bg-red-100 text-red-800': currentPackage.status === 'Retardé',
                                                'px-2 py-1 rounded-full text-xs': true
                                            }">
                                                {{ currentPackage.status || '---' }}
                                            </span>
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h3 class="font-medium text-gray-800 mb-3">Actions</h3>
                                <div class="space-y-3">
                                    <button @click="markAsPrepared" class="w-full bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 flex items-center justify-between">
                                        <span>Marquer comme préparé</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                        </svg>
                                    </button>
                                    <button @click="markAsShipped" class="w-full bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 flex items-center justify-between">
                                        <span>Marquer comme expédié</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                        </svg>
                                    </button>
                                    <button @click="markAsDelivered" class="w-full bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 flex items-center justify-between">
                                        <span>Marquer comme livré</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                        </svg>
                                    </button>
                                    <button @click="generateLabel" class="w-full bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 flex items-center justify-between">
                                        <span>Générer une étiquette</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Dashboard Section -->
                    <section v-if="activeTab === 'dashboard'" class="bg-white rounded-lg shadow p-6">
                        <h2 class="text-xl font-semibold text-gray-800 mb-6">Tableau de bord</h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm text-blue-600">Colis aujourd'hui</p>
                                        <p class="text-2xl font-bold text-blue-800">{{ stats.today }}</p>
                                    </div>
                                    <div class="bg-blue-100 p-2 rounded-full">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                                        </svg>
                                    </div>
                                </div>
                                <p class="text-xs text-blue-500 mt-2">+12% par rapport à hier</p>
                            </div>
                            
                            <div class="bg-green-50 p-4 rounded-lg border border-green-100">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm text-green-600">Colis livrés</p>
                                        <p class="text-2xl font-bold text-green-800">{{ stats.delivered }}</p>
                                    </div>
                                    <div class="bg-green-100 p-2 rounded-full">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </div>
                                </div>
                                <p class="text-xs text-green-500 mt-2">95% taux de réussite</p>
                            </div>
                            
                            <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-100">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-sm text-yellow-600">En retard</p>
                                        <p class="text-2xl font-bold text-yellow-800">{{ stats.delayed }}</p>
                                    </div>
                                    <div class="bg-yellow-100 p-2 rounded-full">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </div>
                                </div>
                                <p class="text-xs text-yellow-500 mt-2">-3% par rapport à hier</p>
                            </div>
                        </div>
                        
                        <div class="mb-8">
                            <h3 class="font-medium text-gray-800 mb-4">Derniers colis scannés</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Code</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Client</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Destination</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Statut</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Heure</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200">
                                        <tr v-for="(pkg, index) in recentPackages" :key="index">
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ pkg.code }}</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ pkg.client }}</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ pkg.destination }}</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span :class="{
                                                    'bg-yellow-100 text-yellow-800': pkg.status === 'En préparation',
                                                    'bg-blue-100 text-blue-800': pkg.status === 'En transit',
                                                    'bg-green-100 text-green-800': pkg.status === 'Livré',
                                                    'bg-red-100 text-red-800': pkg.status === 'Retardé',
                                                    'px-2 py-1 rounded-full text-xs': true
                                                }">
                                                    {{ pkg.status }}
                                                </span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ pkg.time }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </section>

                    <!-- Calendar Section -->
                    <section v-if="activeTab === 'calendar'" class="bg-white rounded-lg shadow p-6">
                        <h2 class="text-xl font-semibold text-gray-800 mb-6">Calendrier des livraisons</h2>
                        <FullCalendar :options="calendarOptions" />
                    </section>

                    <!-- Map Section -->
                    <section v-if="activeTab === 'map'" class="bg-white rounded-lg shadow p-6">
                        <h2 class="text-xl font-semibold text-gray-800 mb-6">Géolocalisation des colis</h2>
                        <div id="map" class="rounded-lg border border-gray-200"></div>
                        
                        <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div v-for="(pkg, index) in packagesOnMap" :key="index" 
                                 @click="focusOnPackage(pkg)"
                                 class="border rounded-lg p-3 hover:bg-gray-50 cursor-pointer transition"
                                 :class="{'border-blue-300 bg-blue-50': pkg.id === focusedPackage}">
                                <div class="flex items-start space-x-3">
                                    <div :class="{
                                        'bg-yellow-500': pkg.status === 'En préparation',
                                        'bg-blue-500': pkg.status === 'En transit',
                                        'bg-green-500': pkg.status === 'Livré',
                                        'bg-red-500': pkg.status === 'Retardé',
                                        'w-3 h-3 rounded-full mt-1 flex-shrink-0': true
                                    }"></div>
                                    <div>
                                        <h3 class="font-medium text-gray-800">{{ pkg.code }}</h3>
                                        <p class="text-sm text-gray-600">{{ pkg.client }}</p>
                                        <p class="text-xs text-gray-500 mt-1">{{ pkg.location }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Labels Section -->
                    <section v-if="activeTab === 'labels'" class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold text-gray-800">Gestion des étiquettes</h2>
                            <button @click="showLabelForm = true" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                </svg>
                                <span>Créer une étiquette</span>
                            </button>
                        </div>

                        <!-- Label Form Modal -->
                        <div v-if="showLabelForm" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-lg font-semibold">Nouvelle étiquette</h3>
                                    <button @click="showLabelForm = false" class="text-gray-500 hover:text-gray-700">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </button>
                                </div>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label for="label-client" class="block text-sm font-medium text-gray-700 mb-1">Client</label>
                                        <input id="label-client" v-model="newLabel.client" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    </div>
                                    
                                    <div>
                                        <label for="label-address" class="block text-sm font-medium text-gray-700 mb-1">Adresse</label>
                                        <textarea id="label-address" v-model="newLabel.address" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                                    </div>
                                    
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label for="label-weight" class="block text-sm font-medium text-gray-700 mb-1">Poids (kg)</label>
                                            <input id="label-weight" v-model="newLabel.weight" type="number" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        </div>
                                        
                                        <div>
                                            <label for="label-ref" class="block text-sm font-medium text-gray-700 mb-1">Référence</label>
                                            <input id="label-ref" v-model="newLabel.reference" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        </div>
                                    </div>
                                    
                                    <div class="flex justify-end space-x-3 pt-4">
                                        <button @click="showLabelForm = false" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">Annuler</button>
                                        <button @click="generateCustomLabel" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Générer l'étiquette</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div v-for="(label, index) in labels" :key="index" class="border rounded-lg p-4 hover:shadow-md transition">
                                <div class="flex justify-between items-start mb-3">
                                    <div>
                                        <h3 class="font-medium text-gray-800">{{ label.client }}</h3>
                                        <p class="text-sm text-gray-500">{{ label.date }}</p>
                                    </div>
                                    <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">{{ label.status }}</span>
                                </div>
                                
                                <div class="text-sm text-gray-600 mb-4">
                                    <p class="truncate">{{ label.address }}</p>
                                    <div class="flex space-x-4 mt-2">
                                        <span class="flex items-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" />
                                            </svg>
                                            {{ label.weight }} kg
                                        </span>
                                        <span class="flex items-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                            </svg>
                                            {{ label.reference }}
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="flex justify-between items-center border-t pt-3">
                                    <button @click="downloadLabel(label)" class="text-blue-600 hover:text-blue-800 flex items-center text-sm">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                        </svg>
                                        Télécharger
                                    </button>
                                    <button @click="printLabel(label)" class="text-gray-600 hover:text-gray-800 flex items-center text-sm">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                                        </svg>
                                        Imprimer
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white py-6">
            <div class="container mx-auto px-4">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0">
                        <div class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                            </svg>
                            <span class="font-bold">MM Stock Scanner</span>
                        </div>
                        <p class="text-sm text-gray-400 mt-1">Solution de gestion logistique pour PME</p>
                    </div>
                    <div class="flex space-x-6">
                        <a href="#" class="text-gray-400 hover:text-white transition">Confidentialité</a>
                        <a href="#" class="text-gray-400 hover:text-white transition">Conditions</a>
                        <a href="#" class="text-gray-400 hover:text-white transition">Support</a>
                    </div>
                </div>
                <div class="border-t border-gray-700 mt-6 pt-6 text-center text-sm text-gray-400">
                    &copy; 2023 MM Stock Scanner. Tous droits réservés.
                </div>
            </div>
        </footer>
    </div>

    <script>
        const { createApp, ref, onMounted, nextTick } = Vue;
        
        createApp({
            setup() {
                // User data
                const userMenuOpen = ref(false);
                const userInitials = ref('AD');
                const darkMode = ref(false);
                
                // Navigation
                const activeTab = ref('dashboard');
                
                // Scanner functionality
                const scannerInput = ref(null);
                const scannedCode = ref('');
                const currentPackage = ref({
                    code: '',
                    client: '',
                    destination: '',
                    status: ''
                });
                
                // Stats
                const stats = ref({
                    today: 24,
                    week: 156,
                    pending: 8,
                    delivered: 142,
                    delayed: 5
                });
                
                // Recent packages
                const recentPackages = ref([
                    { code: 'PKG-2023-001', client: 'Boutique Eco', destination: 'Paris', status: 'Livré', time: '10:45' },
                    { code: 'PKG-2023-002', client: 'Tech Solutions', destination: 'Lyon', status: 'En transit', time: '09:30' },
                    { code: 'PKG-2023-003', client: 'Mode & Style', destination: 'Marseille', status: 'En préparation', time: '08:15' },
                    { code: 'PKG-2023-004', client: 'Librairie du Coin', destination: 'Toulouse', status: 'Retardé', time: 'Hier' },
                    { code: 'PKG-2023-005', client: 'Jardin Bio', destination: 'Nantes', status: 'Livré', time: 'Hier' }
                ]);
                
                // Calendar
                const calendarOptions = ref({
                    plugins: [dayGridPlugin, interactionPlugin],
                    initialView: 'dayGridMonth',
                    events: [
                        { title: 'Livraison Lyon', start: '2023-11-15', color: '#3B82F6' },
                        { title: 'Livraison Paris', start: '2023-11-18', color: '#10B981' },
                        { title: 'Réunion client', start: '2023-11-20', color: '#F59E0B' },
                        { title: 'Scanner inventaire', start: '2023-11-25', color: '#8B5CF6' }
                    ],
                    headerToolbar: {
                        left: 'prev,next today',
                        center: 'title',
                        right: 'dayGridMonth,dayGridWeek'
                    },
                    editable: true,
                    selectable: true,
                    locale: 'fr'
                });
                
                // Map
                let map = null;
                const packagesOnMap = ref([
                    { id: 1, code: 'PKG-2023-001', client: 'Boutique Eco', status: 'Livré', location: 'Paris', lat: 48.8566, lng: 2.3522 },
                    { id: 2, code: 'PKG-2023-002', client: 'Tech Solutions', status: 'En transit', location: 'Lyon', lat: 45.7640, lng: 4.8357 },
                    { id: 3, code: 'PKG-2023-003', client: 'Mode & Style', status: 'En préparation', location: 'Marseille', lat: 43.2965, lng: 5.3698 },
                    { id: 4, code: 'PKG-2023-004', client: 'Librairie du Coin', status: 'Retardé', location: 'Toulouse', lat: 43.6045, lng: 1.4440 },
                    { id: 5, code: 'PKG-2023-005', client: 'Jardin Bio', status: 'Livré', location: 'Nantes', lat: 47.2184, lng: -1.5536 }
                ]);
                const focusedPackage = ref(null);
                
                // Labels
                const showLabelForm = ref(false);
                const newLabel = ref({
                    client: '',
                    address: '',
                    weight: '',
                    reference: ''
                });
                const labels = ref([
                    { client: 'Boutique Eco', address: '12 Rue de la Paix, 75002 Paris', weight: 2.5, reference: 'ECO-123', status: 'Imprimée', date: 'Aujourd\'hui' },
                    { client: 'Tech Solutions', address: '45 Avenue des Technologies, 69001 Lyon', weight: 5.2, reference: 'TECH-456', status: 'Générée', date: 'Hier' },
                    { client: 'Mode & Style', address: '8 Boulevard de la Mode, 13008 Marseille', weight: 1.8, reference: 'FASH-789', status: 'En attente', date: '15/11/2023' }
                ]);
                
                // Methods
                const toggleDarkMode = () => {
                    darkMode.value = !darkMode.value;
                    document.documentElement.classList.toggle('dark', darkMode.value);
                };
                
                const processScan = () => {
                    // Simulate API call to get package info
                    const fakePackageData = {
                        '123456': { code: 'PKG-2023-006', client: 'Nouveau Client', destination: 'Bordeaux', status: 'En préparation' },
                        '789012': { code: 'PKG-2023-007', client: 'Auto Parts', destination: 'Lille', status: 'En préparation' },
                        '345678': { code: 'PKG-2023-008', client: 'Electro Maison', destination: 'Strasbourg', status: 'En préparation' }
                    };
                    
                    if (fakePackageData[scannedCode.value]) {
                        currentPackage.value = fakePackageData[scannedCode.value];
                        recentPackages.value.unshift({
                            ...fakePackageData[scannedCode.value],
                            time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                        });
                        
                        // Add to map if not already there
                        if (!packagesOnMap.value.some(pkg => pkg.code === fakePackageData[scannedCode.value].code)) {
                            const cities = [
                                { name: 'Bordeaux', lat: 44.8378, lng: -0.5792 },
                                { name: 'Lille', lat: 50.6292, lng: 3.0573 },
                                { name: 'Strasbourg', lat: 48.5734, lng: 7.7521 }
                            ];
                            const city = cities.find(c => c.name === fakePackageData[scannedCode.value].destination) || cities[0];
                            
                            packagesOnMap.value.push({
                                id: packagesOnMap.value.length + 1,
                                code: fakePackageData[scannedCode.value].code,
                                client: fakePackageData[scannedCode.value].client,
                                status: fakePackageData[scannedCode.value].status,
                                location: fakePackageData[scannedCode.value].destination,
                                lat: city.lat,
                                lng: city.lng
                            });
                        }
                        
                        stats.value.today++;
                        stats.value.week++;
                    } else {
                        currentPackage.value = { code: scannedCode.value, client: 'Inconnu', destination: 'Non spécifié', status: 'Non reconnu' };
                    }
                    
                    scannedCode.value = '';
                    nextTick(() => {
                        scannerInput.value.focus();
                    });
                };
                
                const markAsPrepared = () => {
                    if (currentPackage.value.code) {
                        currentPackage.value.status = 'En préparation';
                        updatePackageStatus(currentPackage.value.code, 'En préparation');
                    }
                };
                
                const markAsShipped = () => {
                    if (currentPackage.value.code) {
                        currentPackage.value.status = 'En transit';
                        updatePackageStatus(currentPackage.value.code, 'En transit');
                    }
                };
                
                const markAsDelivered = () => {
                    if (currentPackage.value.code) {
                        currentPackage.value.status = 'Livré';
                        updatePackageStatus(currentPackage.value.code, 'Livré');
                        stats.value.delivered++;
                        stats.value.pending--;
                    }
                };
                
                const updatePackageStatus = (code, status) => {
                    // Update in recent packages
                    const pkgIndex = recentPackages.value.findIndex(pkg => pkg.code === code);
                    if (pkgIndex !== -1) {
                        recentPackages.value[pkgIndex].status = status;
                    }
                    
                    // Update in map packages
                    const mapPkgIndex = packagesOnMap.value.findIndex(pkg => pkg.code === code);
                    if (mapPkgIndex !== -1) {
                        packagesOnMap.value[mapPkgIndex].status = status;
                    }
                };
                
                const generateLabel = () => {
                    if (!currentPackage.value.code) return;
                    
                    // Simulate label generation
                    const newLabel = {
                        client: currentPackage.value.client || 'Client Générique',
                        address: `Adresse de ${currentPackage.value.client || 'livraison'}, ${currentPackage.value.destination || 'Ville'}`,
                        weight: (Math.random() * 5 + 0.5).toFixed(1),
                        reference: `REF-${currentPackage.value.code.slice(-3)}`,
                        status: 'Générée',
                        date: 'Aujourd\'hui'
                    };
                    
                    labels.value.unshift(newLabel);
                    showLabelForm.value = false;
                    
                    // Show success message
                    alert(`Étiquette pour ${currentPackage.value.code} générée avec succès!`);
                };
                
                const generateCustomLabel = () => {
                    if (!newLabel.value.client) return;
                    
                    // Add new label
                    labels.value.unshift({
                        client: newLabel.value.client,
                        address: newLabel.value.address,
                        weight: newLabel.value.weight,
                        reference: newLabel.value.reference || `REF-${Math.floor(Math.random() * 1000)}`,
                        status: 'Générée',
                        date: 'Aujourd\'hui'
                    });
                    
                    // Reset form
                    newLabel.value = {
                        client: '',
                        address: '',
                        weight: '',
                        reference: ''
                    };
                    
                    showLabelForm.value = false;
                    
                    // Show success message
                    alert('Nouvelle étiquette générée avec succès!');
                };
                
                const printLastLabel = () => {
                    if (labels.value.length === 0) return;
                    alert(`Impression de l'étiquette pour ${labels.value[0].client}...`);
                };
                
                const printLabel = (label) => {
                    alert(`Impression de l'étiquette pour ${label.client}...`);
                };
                
                const downloadLabel = (label) => {
                    alert(`Téléchargement de l'étiquette pour ${label.client}...`);
                };
                
                const focusOnPackage = (pkg) => {
                    focusedPackage.value = pkg.id;
                    map.setView([pkg.lat, pkg.lng], 12);
                };
                
                // Lifecycle hooks
                onMounted(() => {
                    // Initialize map
                    map = L.map('map').setView([46.6031, 1.8883], 6);
                    
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                    }).addTo(map);
                    
                    // Add markers for packages
                    packagesOnMap.value.forEach(pkg => {
                        const marker = L.marker([pkg.lat, pkg.lng]).addTo(map)
                            .bindPopup(`<b>${pkg.code}</b><br>${pkg.client}<br>Statut: ${pkg.status}`);
                        
                        if (pkg.status === 'Retardé') {
                            marker.setIcon(
                                L.icon({
                                    iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png',
                                    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                                    iconSize: [25, 41],
                                    iconAnchor: [12, 41],
                                    popupAnchor: [1, -34],
                                    shadowSize: [41, 41]
                                })
                            );
                        } else if (pkg.status === 'En transit') {
                            marker.setIcon(
                                L.icon({
                                    iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png',
                                    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                                    iconSize: [25, 41],
                                    iconAnchor: [12, 41],
                                    popupAnchor: [1, -34],
                                    shadowSize: [41, 41]
                                })
                            );
                        } else if (pkg.status === 'Livré') {
                            marker.setIcon(
                                L.icon({
                                    iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png',
                                    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                                    iconSize: [25, 41],
                                    iconAnchor: [12, 41],
                                    popupAnchor: [1, -34],
                                    shadowSize: [41, 41]
                                })
                            );
                        }
                    });
                    
                    // Auto-focus scanner input
                    if (scannerInput.value) {
                        scannerInput.value.focus();
                    }
                });
                
                return {
                    // Refs
                    userMenuOpen,
                    userInitials,
                    darkMode,
                    activeTab,
                    scannerInput,
                    scannedCode,
                    currentPackage,
                    stats,
                    recentPackages,
                    calendarOptions,
                    packagesOnMap,
                    focusedPackage,
                    showLabelForm,
                    newLabel,
                    labels,
                    
                    // Methods
                    toggleDarkMode,
                    processScan,
                    markAsPrepared,
                    markAsShipped,
                    markAsDelivered,
                    generateLabel,
                    generateCustomLabel,
                    printLastLabel,
                    printLabel,
                    downloadLabel,
                    focusOnPackage
                };
            }
        }).mount('#app');
    </script>
</body>
</html>